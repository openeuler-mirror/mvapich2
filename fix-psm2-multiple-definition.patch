From 2a2bbf44e134a412df54f33c41d49b36f04c50e7 Mon Sep 17 00:00:00 2001
From: sunguoshuai <sunguoshuai@huawei.com>
Date: Sat, 7 Aug 2021 15:01:35 +0800
Subject: [PATCH] for psm2 multiple definition

---
 src/mpid/ch3/channels/psm/include/psmpriv.h | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/src/mpid/ch3/channels/psm/include/psmpriv.h b/src/mpid/ch3/channels/psm/include/psmpriv.h
index ee6848b..958c5f9 100644
--- a/src/mpid/ch3/channels/psm/include/psmpriv.h
+++ b/src/mpid/ch3/channels/psm/include/psmpriv.h
@@ -212,10 +212,10 @@
                              (_len < ipath_rndv_thresh))
 
 int psm_no_lock(pthread_spinlock_t *);
-int (*psm_lock_fn)(pthread_spinlock_t *);
-int (*psm_unlock_fn)(pthread_spinlock_t *);
-int (*psm_progress_lock_fn)(pthread_spinlock_t *);
-int (*psm_progress_unlock_fn)(pthread_spinlock_t *);
+extern int (*psm_lock_fn)(pthread_spinlock_t *);
+extern int (*psm_unlock_fn)(pthread_spinlock_t *);
+extern int (*psm_progress_lock_fn)(pthread_spinlock_t *);
+extern int (*psm_progress_unlock_fn)(pthread_spinlock_t *);
 
 #define MAX_PROGRESS_HOOKS 4
 typedef int (*progress_func_ptr_t) (int* made_progress);
@@ -225,7 +225,7 @@ typedef struct progress_hook_slot {
     int active;
 } progress_hook_slot_t;
 
-progress_hook_slot_t progress_hooks[MAX_PROGRESS_HOOKS];
+extern progress_hook_slot_t progress_hooks[MAX_PROGRESS_HOOKS];
 
 #define _psm_enter_  psm_lock_fn(&psmlock)
 #define _psm_exit_   psm_unlock_fn(&psmlock)
-- 
2.30.0

